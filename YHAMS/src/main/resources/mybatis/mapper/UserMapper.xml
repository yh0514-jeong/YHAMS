<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yhams.user.UserMapper">

	
	<select id="getUserList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
	
		SELECT  T1.RNUM,
		        T1.USER_INFO,
		        T1.USER_SEQ,
		        T1.USER_ID,
		        T1.USER_NM,
		        T1.USER_NM_EN,
		        T1.USER_EMAIL
	     
	     FROM (SELECT  ROW_NUMBER() OVER(ORDER BY USER_SEQ DESC) AS RNUM,
	                   CONCAT(USER_NM, '(', USER_ID, ')') AS USER_INFO,       
				       USER_SEQ,
		               USER_ID,
		               USER_NM,
		               USER_NM_EN,
		               USER_EMAIL
			      FROM TB_META_USER
			
			      WHERE USER_SEQ NOT IN (SELECT DISTINCT USER_SEQ
			                               FROM TB_META_USER_ROLE_MAPPING)
					AND (
					     USER_NM LIKE CONCAT('%',#{searchContent},'%') OR 
					     USER_ID LIKE CONCAT('%',#{searchContent},'%') 
					     )
			    ) T1
		
		ORDER BY T1.RNUM DESC
		
	</select>


</mapper>